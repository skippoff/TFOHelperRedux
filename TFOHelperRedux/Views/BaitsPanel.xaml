<UserControl x:Class="TFOHelperRedux.Views.BaitsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:TFOHelperRedux.Views"
             xmlns:views="clr-namespace:TFOHelperRedux.Views"
             xmlns:conv="clr-namespace:TFOHelperRedux.Converters"
             xmlns:viewModels="clr-namespace:TFOHelperRedux.ViewModels">

    <UserControl.Resources>
        <conv:StringToImageSourceConverter x:Key="ImgConverter"/>
        <conv:EqualityToVisibilityConverter x:Key="EqualityToVisibilityConverter"/>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="380"/>
            <!-- левая панель -->
            <ColumnDefinition Width="500"/>
            <!-- рецепты -->
            <ColumnDefinition Width="*"/>
            <!-- рыбы -->
        </Grid.ColumnDefinitions>
        <!-- ====================== LEFT PANEL ====================== -->
        <Border Grid.Column="0"
                Background="{StaticResource PanelBackground}"
                BorderBrush="{StaticResource BorderBrushLight}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="12"
                Margin="2">
            <Grid DataContext="{Binding BaitsVM}">
                <!-- Прикормки -->
                <Border Visibility="{Binding DataContext.BaitsSubMode, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EqualityToVisibilityConverter}, ConverterParameter=Feeds}">
                    <ListBox ItemsSource="{Binding Feeds}"
                             SelectedItem="{Binding SelectedFeed, Mode=TwoWay}"
                             Background="Transparent"
                             BorderThickness="0"
                             ItemContainerStyle="{StaticResource RoundedCardStyle}"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             MouseDoubleClick="Ingredient_MouseDoubleClick">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Width="100" Height="100" Margin="4"
                                        BorderBrush="#DDD" BorderThickness="1"
                                        CornerRadius="6" Padding="4">
                                    <StackPanel>
                                        <Image Source="{Binding ImagePath, Converter={StaticResource ImgConverter}}" Height="50" Stretch="Uniform"/>
                                        <TextBlock Text="{Binding Name}" FontSize="13" TextAlignment="Center" Margin="0,4,0,0" TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
                <!-- Дипы -->
                <Border Visibility="{Binding DataContext.BaitsSubMode, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EqualityToVisibilityConverter}, ConverterParameter=Dips}">
                    <ListBox ItemsSource="{Binding Dips}"
                             SelectedItem="{Binding SelectedDip, Mode=TwoWay}"
                             Background="Transparent"
                             BorderThickness="0"
                             ItemContainerStyle="{StaticResource RoundedCardStyle}"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             MouseDoubleClick="Ingredient_MouseDoubleClick">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Width="100" Height="100" Margin="4"
                                        BorderBrush="#DDD" BorderThickness="1"
                                        CornerRadius="6" Padding="4">
                                    <StackPanel>
                                        <Image Source="{Binding ImagePath, Converter={StaticResource ImgConverter}}" Height="50" Stretch="Uniform"/>
                                        <TextBlock Text="{Binding Name}" FontSize="13" TextAlignment="Center" Margin="0,4,0,0" TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
                <!-- Наживки -->
                <Border Visibility="{Binding DataContext.BaitsSubMode, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EqualityToVisibilityConverter}, ConverterParameter=Lures}">
                    <ListBox ItemsSource="{Binding Lures}"
                             SelectedItem="{Binding SelectedLure, Mode=TwoWay}"
                             Background="Transparent"
                             BorderThickness="0"
                             ItemContainerStyle="{StaticResource RoundedCardStyle}"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             MouseDoubleClick="Ingredient_MouseDoubleClick">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Width="100" Height="100" Margin="4"
                                        BorderBrush="#DDD" BorderThickness="1"
                                        CornerRadius="6" Padding="4">
                                    <StackPanel>
                                        <Image Source="{Binding ImagePath, Converter={StaticResource ImgConverter}}" Height="50" Stretch="Uniform"/>
                                        <TextBlock Text="{Binding Name}" FontSize="13" TextAlignment="Center" Margin="0,4,0,0" TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
                <!-- Компоненты -->
                <Border Visibility="{Binding DataContext.BaitsSubMode, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource EqualityToVisibilityConverter}, ConverterParameter=FeedComponents}">
                    <ListBox ItemsSource="{Binding Components}"
                             SelectedItem="{Binding SelectedComponent, Mode=TwoWay}"
                             Background="Transparent"
                             BorderThickness="0"
                             ItemContainerStyle="{StaticResource RoundedCardStyle}"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             MouseDoubleClick="Ingredient_MouseDoubleClick">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Width="100" Height="100" Margin="4"
                                        BorderBrush="#DDD" BorderThickness="1"
                                        CornerRadius="6" Padding="4">
                                    <StackPanel>
                                        <Image Source="{Binding ImagePath, Converter={StaticResource ImgConverter}}" Height="50" Stretch="Uniform"/>
                                        <TextBlock Text="{Binding Name}" FontSize="13" TextAlignment="Center" Margin="0,4,0,0" TextTrimming="CharacterEllipsis"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Border>
            </Grid>
        </Border>
        <!-- ====================== RECIPE / CRAFT PANEL ====================== -->
        <Border Grid.Column="1"
                Background="{StaticResource PanelBackground}"
                BorderBrush="{StaticResource BorderBrushLight}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="2"
                Margin="2">
            <Grid>
                <!-- Обычные рецепты прикорма -->
                <local:BaitRecipesPanel Grid.Row="0"
                                        DataContext="{Binding BaitRecipesVM}" />
            </Grid>
        </Border>
        <!-- ====================== FISH PANEL (ALWAYS VISIBLE HERE) ====================== -->
        <Border Grid.Column="2"
                Background="{StaticResource PanelBackground}"
                BorderBrush="{StaticResource BorderBrushLight}"
                BorderThickness="1"
                CornerRadius="6"
                Padding="6"
                Margin="2">
            <local:FishSelectorPanel/>
        </Border>
    </Grid>
</UserControl>
