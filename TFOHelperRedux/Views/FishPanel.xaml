<UserControl x:Class="TFOHelperRedux.Views.FishPanel"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:local="clr-namespace:TFOHelperRedux.Views"
      xmlns:vm="clr-namespace:TFOHelperRedux.ViewModels"
      xmlns:helpers="clr-namespace:TFOHelperRedux.Helpers"
      xmlns:app="clr-namespace:TFOHelperRedux">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="575"/>
            
        </Grid.ColumnDefinitions>
        <Border Grid.Column="0"
            Margin="2"
            Background="{DynamicResource PanelBackground}"
            CornerRadius="6"
            BorderBrush="{DynamicResource BorderBrushLight}"
            BorderThickness="1"
            Padding="12"
            Visibility="{Binding CurrentMode, Converter={StaticResource EqualityToVisibilityConverter}, ConverterParameter={x:Static helpers:NavigationModes.Fish}}">
            <ListBox x:Name="FishList" ItemsSource="{Binding FilteredFishes}"
             SelectedItem="{Binding SelectedFish, Mode=TwoWay}"
             Background="Transparent"
             BorderThickness="0"
             ScrollViewer.VerticalScrollBarVisibility="Auto"
             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
             HorizontalContentAlignment="Stretch"
             VirtualizingPanel.IsVirtualizing="True"
             VirtualizingPanel.VirtualizationMode="Recycling"
             ScrollViewer.IsDeferredScrollingEnabled="True">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel IsItemsHost="True" Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>

                <ListBox.ItemContainerStyle>
                    <Style TargetType="ListBoxItem" BasedOn="{StaticResource FishCardStyle}"/>
                </ListBox.ItemContainerStyle>

                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Grid Width="144" Height="94">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Viewbox Grid.Row="0" MaxHeight="56" MaxWidth="112" Margin="0,4">
                                <Image Source="{Binding ImagePath, Converter={StaticResource ImgConverter}, IsAsync=True}"
                               Stretch="Uniform"/>
                            </Viewbox>
                            <TextBlock Grid.Row="1"
                               Text="{Binding Name}"
                               FontSize="15"
                               FontWeight="Medium"
                               TextAlignment="Center"
                               Margin="2,6,2,0"
                               TextTrimming="CharacterEllipsis"
                               Foreground="{DynamicResource TextPrimary}"/>
                        </Grid>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Border>
        <!-- RIGHT: панель деталей -->
    </Grid>
</UserControl>
